#!/usr/bin/env bash
set -euo pipefail

cd "$(dirname "$0")"

usage() {
    echo "Usage: ./dev <tool> [args...]"
    echo ""
    echo "Tools:"
    echo "  autarch    - Build and run unified Autarch CLI"
    echo "  bigend     - Build and run Bigend (mission control)"
    echo "  pollard    - Build and run Pollard (research intelligence)"
    echo "  gurgeh     - Build and run Gurgeh (PRD generation)"
    echo "  coldwine   - Build and run Coldwine (task tracker)"
    echo ""
    echo "Legacy aliases (backward compatibility):"
    echo "  vauxhall   -> bigend"
    echo "  praude     -> gurgeh"
    echo "  tandemonium -> coldwine"
    echo ""
    echo "Examples:"
    echo "  ./dev autarch tui        # Unified TUI with onboarding"
    echo "  ./dev bigend --tui       # TUI mode"
    echo "  ./dev bigend --daemon    # Daemon mode (schmux-style)"
    echo "  ./dev pollard init       # Initialize Pollard in project"
    echo "  ./dev pollard scan       # Run research agents"
    echo "  ./dev gurgeh list        # List PRDs/specs"
    echo "  ./dev coldwine status    # Show task status"
    exit 1
}

if [ $# -lt 1 ]; then
    usage
fi

TOOL="$1"
shift

case "$TOOL" in
    autarch)
        go build -o autarch ./cmd/autarch
        exec ./autarch "$@"
        ;;
    bigend|vauxhall)
        go build -o bigend ./cmd/bigend
        exec ./bigend "$@"
        ;;
    pollard)
        go build -o pollard ./cmd/pollard
        exec ./pollard "$@"
        ;;
    gurgeh|praude)
        go build -o gurgeh ./cmd/gurgeh
        exec ./gurgeh "$@"
        ;;
    coldwine|tandemonium)
        go build -o coldwine ./cmd/coldwine
        exec ./coldwine "$@"
        ;;
    *)
        echo "Unknown tool: $TOOL"
        usage
        ;;
esac
